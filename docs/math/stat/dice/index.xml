<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>サイコロの出目の確率 on htakeuchi0 のノート</title><link>https://htakeuchi0.github.io/docs/math/stat/dice/</link><description>Recent content in サイコロの出目の確率 on htakeuchi0 のノート</description><generator>Hugo -- gohugo.io</generator><language>ja-jp</language><atom:link href="https://htakeuchi0.github.io/docs/math/stat/dice/index.xml" rel="self" type="application/rss+xml"/><item><title>サイコロを繰り返し投げる試行の確率モデル</title><link>https://htakeuchi0.github.io/docs/math/stat/dice/dice_basic/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://htakeuchi0.github.io/docs/math/stat/dice/dice_basic/</guid><description>サイコロを繰り返し投げる試行の確率モデル # 概要 # 本ページでは，サイコロを繰り返し投げる試行の確率モデルを定義します．
確率の定義 # 確率の定義は以下の通りです．
Definition 1.
\(X\) を集合とする．\(\mathfrak{F}\subset2^X\) が \(X\) の完全加法族であるとは，次の1&amp;ndash;3を満たすことである．ただし，\(A^c=X-A=\{x\in X\mid x\notin a\}\), \(2^X=\{A\mid A\subset X\}\) とする． \(\emptyset\in\mathfrak{F}\), \(A\in\mathfrak{F}\) ならば \(A^c\in\mathfrak{F}\), 任意の \(i\in\mathbb{N}\) について \(A_i\in\mathfrak{F}\) ならば \(\bigcup_{i=1}^{\infty}A_i\in\mathfrak{F}\). \(\Omega\) を集合とし，\(\mathfrak{F}\) を \(\Omega\) の完全加法族とする．\((\Omega,\mathfrak{F})\) を標本空間, \(\mathfrak{F}\) の点を事象，\(\Omega\) の点を標本点という． \(\Omega\) を集合とし，\(\mathfrak{F}\) を \(\Omega\) の完全加法族とする．関数 \(P:\mathfrak{F}\to\mathbb{R}\) が次の1&amp;ndash;3を満たすとき，関数 \(P\) を確率という．ただし，集合 \(A_1,A_2,\dots\) が互いに素とは，どの \(i,j\ (i\neq j)\) についても \(A_i\cap A_j=\emptyset\) であることをいい，\(A_1,A_2,\dots\) が互いに素であるとき，\(\bigcup_{i=1}^{\infty}A_i\) を \(\sum_{i=1}^{\infty}A_i\) と表す． \(A\in\mathfrak{F}\) ならば \(P(A)\ge0\), \(P(\Omega)=1\), \(A_1,A_2,\dots\in\mathfrak{F}\) が互いに素ならば，\(P(\sum_{i=1}^{\infty}A_i)=\sum_{i=1}^{\infty}P(A_i)\). \(\Omega\) を集合とし，\(\mathfrak{F}\) を \(\Omega\) の完全加法族とする．関数 \(P:\mathfrak{F}\to\mathbb{R}\) を確率とする．このとき，\((\Omega,\mathfrak{F},P)\) を確率空間という． 偏りのないサイコロを1回だけ投げる試行の確率モデル # まずは，偏りのないサイコロを1回だけ投げる試行の確率モデルを考えます．</description></item><item><title>サイコロをN回投げたときちょうど6回に1回の割合で1の目が出る確率</title><link>https://htakeuchi0.github.io/docs/math/stat/dice/dice_ratio/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://htakeuchi0.github.io/docs/math/stat/dice/dice_ratio/</guid><description>サイコロをN回投げたときちょうど6回に1回の割合で1の目が出る確率 # 概要 # 前ページでは，サイコロを繰り返し投げる試行の確率モデルを定義しました．
本ページからは，サイコロを繰り返し投げると，およそ6回に1回程度の割合で1の目が出ることを確認します．
しかし，そもそもこれはどのように確認したらよいのでしょうか．
本ページではひとまず，ちょうど 6回に1回の割合で1の目が出る確率を計算してみます．
まず，サイコロを \(N\) 回投げたとき \(k\) 回だけ1の目が出る確率を求めます．その後，サイコロを繰り返し投げたとき，ちょうど 6回に1回の割合で1の目が出る確率を求めます．
サイコロをN回投げたときk回だけ1の目が出る確率 # いま，確率空間 \((\Omega_N,\mathfrak{F}_N,P_N)\) を考えます． \(A_k=\{(\omega^j)\in\Omega_N\mid |\{j\mid \omega^j=\omega_1\}|=k\}\) とすると， \(A_k\) は \(N\) 回サイコロをなげて \(k\) 回だけ1の目が出た事象を表します．
\((\omega^j)\in A_k\) とすると， \(\omega^1,\omega^2,\dots,\omega^N\) のうち \(k\) 個が \(\omega_1\) ですが，これは \(N\) 個から \(k\) 個を選ぶ選び方を考えればよいので， \(\binom{N}{k}=N!/(k!(N-k)!)\) 個あります．
このとき，ある \(\{i_1,i_2,\dots,i_k\}\subset\{1,2,\dots,N\}\) について， \(k\) 個の要素 \(\omega^{i_j}\,(j=1,2,\dots,k)\) は \(\omega_1\) の1通りの値しかとれませんが，それ以外の \(N-k\) 個の要素は \(\omega_2,\omega_3,\dots,\omega_6\) の5通りの値をとれます．
したがって， \(|A_k|=\binom{N}{k}5^{N-k}\) とわかります．さらに， \(|\Omega_N|=6^N\) なので， \(P_N(A_k)=\binom{N}{k}5^{N-k}/6^N\) となります．
よって，以下のことがいえそうです．
Proposition 1. 偏りのないサイコロを \(N\) 回投げて \(k\) 回だけ1の目が出る確率は</description></item><item><title>サイコロをN回投げたときおよそ6回に1回程度の割合で1の目が出ることの確認</title><link>https://htakeuchi0.github.io/docs/math/stat/dice/dice_approx_ratio/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://htakeuchi0.github.io/docs/math/stat/dice/dice_approx_ratio/</guid><description>サイコロをN回投げたときおよそ6回に1回程度の割合で1の目が出ることの確認 # 概要 # サイコロを繰り返し投げると，およそ6回に1回程度の割合で1の目が出ることを確認したいと思いますが，ちょうど6回に1回の割合で出るわけではないことがわかりました．
そこで，本ページでは，およそ6回に1回程度の割合で出ることを確認する方法を考えます．
いま， \(p(N,k)=\binom{N}{k}5^{N-k}/6^N\) とします．
このとき，以下の方針が考えられます．
\(p(N,k)\) が最大となる \(k\) が，およそ \(N/6\) であることを確認する． サイコロを繰り返し投げると，平均的に \(N/6\) 程度の回数だけ1の目が出ることを確認する． 1は， \(N\) を固定したとき，1の目が出る回数として最もあり得るのがおよそ \(N/6\) のときであることを確認する方針です．
2は，サイコロを \(N\) 投げる試行自体を繰り返すと，試行ごとにばらつきがあるが，平均的には \(N/6\) 回程度1の目が出ることを確認する方針です．
確率が最大となる1の目の出る回数がN/6程度であることの確認 # まず， \(p(N,k)\) を数値的に計算してみます． \(N=10,100,1000\) の場合を計算しますが，値が小さくなりすぎるので， \(\log_{10}p(N,k)\) を計算することにします．
縦軸・横軸のスケールが各グラフで異なる点に注意してください．
Figure 1. N=10の場合 Figure 2. N=100の場合 Figure 3. N=1000の場合 Figs. 1&amp;ndash;3 より， \(k=k_0\) で \(p(N,k)\) が最大になるとき， \(k&amp;lt;k_0\) の範囲では \(p(N,k)\) は大きくなり， \(k&amp;gt;k_0\) の範囲では， \(p(N,k)\) は小さくなるようです．よって，この頂点となる \(k=k_0\) が \(N/6\) 程度だとわかればよさそうです．
\(p(N,k)&amp;gt;0\) なので， \(p(N,k&amp;#43;1)/p(N,k)\) を計算すると，</description></item><item><title>サイコロをN回投げたときおよそ6回に1回程度の割合で1の目が出ることの確率変数の導入による整理</title><link>https://htakeuchi0.github.io/docs/math/stat/dice/dice_randval/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://htakeuchi0.github.io/docs/math/stat/dice/dice_randval/</guid><description>サイコロをN回投げたときおよそ6回に1回程度の割合で1の目が出ることの確率変数の導入による整理 # 概要 # 前ページまでで，サイコロを \(N\) 回投げるとき，次が成り立つことがわかりました．
確率が最大となる1の目の出る回数は \(N/6\) 程度である 平均的に \(N/6\) 回程度，1の目が出る しかし，もとの“およそ6回に1回程度の割合で1の目が出る”という主張に対して，平均といった概念をもちだしているなど，直接的な結果に感じません．
そこで本ページでは，確率変数を導入することで，この問題をより取り扱いやすくして，およそ6回に1回程度の割合で1の目が出ることを，より直接的に示せないかを検討します．
確率変数 # まずは，確率変数の定義について述べます．
Definition 1.
\(A\) を集合，\(\mathfrak{F}\) をその完全加法族とする．一般に，\((A,\mathfrak{F})\) を 可測空間 という．また，\((A,\mathfrak{F}),(B,\mathfrak{G})\) を可測空間とするとき，関数 \(F:A\to B\) を \(F:(A,\mathfrak{F})\to(B,\mathfrak{B})\) と表す． \((A,\mathfrak{F}),(B,\mathfrak{G})\) を可測空間とする．関数 \(F:(A,\mathfrak{F})\to (B,\mathfrak{F})\) が，任意の \(b\in B\) について \(F^{-1}(b)=\{a\in A\mid F(a)=b\}\in\mathfrak{F}\) であるとき，関数 \(F\) を可測関数と呼ぶ． \(\mathbb{R}\) の開集合全体の集合を \(\mathfrak{O}(\mathbb{R})\) と表す．\(\mathfrak{O}(\mathbb{R})\) を含む最小の完全加法族を \(\mathfrak{B}(\mathbb{R})\) と表す． \(\Omega,\mathfrak{F}\) を標本空間とする，\(X:(\Omega,\mathfrak{F})\to(\mathbb{R},\mathfrak{B}(\mathbb{R}))\) が可測関数のとき，\(X\) を確率変数という． なお，可測空間も標本空間も集合とその完全加法族の組なので，実質的には同じものですが，数理統計の文脈では，可測空間のことを標本空間と呼ぶ，という理解でよいです．また，本来は \(\mathfrak{B}(\mathbb{R})\) の存在を示す必要がありますが，ここでは認めるものとします．
\(X\) の像 \(X(\Omega)=\{x\in\mathbb{R}\mid \exists \omega\in\Omega\,(X(\omega)=x)\}\) が高々可算のとき， \(X\) は離散型確率変数と呼ばれます．
ここで， \([X=x]=\{\omega\in\Omega_N\mid X(\omega)=x\}\) とし， \(P([X=x])\) を \(P(X=x)\) と略記することにします． \([X&amp;lt;x],[X\le x],P(X&amp;lt;x),P(X\le x)\) なども同様です．</description></item><item><title>サイコロを無限回投げる場合の確率モデル</title><link>https://htakeuchi0.github.io/docs/math/stat/dice/dice_inf/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://htakeuchi0.github.io/docs/math/stat/dice/dice_inf/</guid><description>サイコロを無限回投げる場合の確率モデル # 概要 # 前ページまでで，サイコロを繰り返し投げる試行の確率モデルを定義しました．しかし，投げる回数 \(N\) を固定した場合でしか説明していません．
本ページでは，サイコロを無限回投げる場合の確率モデルについて説明します．有限の場合ほど明らかではないので，ひとつずつ確認しながら構成します．
確率の定義 # 既に述べたとおり， \(\Omega\) を集合， \(\mathfrak{F}\) を \(\Omega\) の完全加法族としたとき，以下を満たす関数 \(P:\mathfrak{F}\to\mathbb{R}\) を確率と呼ぶのでした．
\(A\in\mathfrak{F}\) ならば \(P(A)\ge0\), \(P(\Omega)=1\), \(A_1,A_2,\dots\in\mathfrak{F}\) が互いに素ならば，\(P(\sum_{i=1}^{\infty}A_i)=\sum_{i=1}^{\infty}P(A_i)\). また， \((\Omega,\mathfrak{F},P)\) を確率空間と呼ぶのでした．
サイコロを無限回投げる場合を表す確率空間の具体的構成 # 以降では，サイコロを無限回投げる場合を表す確率空間 \((\Omega_{\infty},\mathfrak{F}_{\infty},P_{\infty})\) を具体的に構成します．
\(\Omega_\infty\) の構成 # \(\Omega_1=\{\omega_1,\omega_2,\dots,\omega_6\}\) とし， \(\Omega_{\infty}\) を，
\[\Omega_{\infty}=\{(\omega^i)_{i\in\mathbb{N}}\mid\forall i\in\mathbb{N}\,(\omega^i\in\Omega_1)\}\] つまり， \(\Omega_{\infty}=\Omega^{\mathbb{N}}\) とします1, 2．
\(\mathfrak{F}_{\infty},P_{\infty}\) の構成 # \(\mathfrak{F}_{\infty},P_{\infty}\) を定めるには準備が必要です． まず， \(1\le k\in\mathbb{N}\) について， \[N^{(k)}=\{(n_1,n_2,\dots,n_k)\in\mathbb{N}^k\mid 1\le n_1&amp;lt;\dots&amp;lt;n_k\}\] とし， \(N^{(0)}=\{\emptyset\}\) とします．
次に， \(1\le k\in\mathbb{N}\) に対し， \(\Omega\in2^{\Omega_1^k},n\in N^{(k)}\) に対して， \[F_{k,\Omega,n}=\{\omega\in\Omega_{\infty}\mid(\omega^{n_1},\omega^{n_2},\dots,\omega^{n_k})\in\Omega\}\] とし， \(F_{0,\Omega,n}=\Omega_{\infty}\) とします．</description></item></channel></rss>