<!doctype html><html lang=ja-jp dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="特殊なラプラス分布や切断ラプラス分布のパラメータ推定 # 概要 # 前ページ では，ラプラス分布や切断ラプラス分布からのサンプリングについてまとめました．
本ページでは，ラプラス分布や切断ラプラス分布に従う乱数から，各分布のパラメータを推定する方法についてまとめます．
ただし，本節は，簡易な直接計算でラプラス分布の性質を述べることを目的としているので，すべてのパラメータでなく，一部のパラメータのみを推定する場合を考えます．
具体的には， \(\mu\) は \(0\) に固定し，切断ラプラス分布では左右対称な分布となるケースのみを考えます．
\(\mu=0\) であるラプラス分布のパラメータ推定 # いま， \(X_1,X_2,\dots,X_N\) を，独立にパラメータ \(\mu,b\) のラプラス分布に従う確率変数とし， \(\mu=0\) とします．
このとき， \[ f_{X_1,X_2,\dots,X_N}(x_1,x_2,\dots,x_N;b)=\prod_{i=1}^N\frac{1}{2b}\exp\left(-\frac{|x_i|}{b}\right)\] と表されます． \(\mathcal{L}_{x_1,\dots,x_N}(b)=\log f_{X_1,X_2,\dots,X_N}(x_1,x_2,\dots,x_N;b)\) とおくと， \[\begin{aligned} \mathcal{L}_{x_1,\dots,x_N}(b)&=\log\prod_{i=1}^N\frac{1}{2b}\exp\left(-\frac{|x_i|}{b}\right)\\ &=\sum_{i=1}^N\left(\log\frac{1}{2b}+\log\exp\left(-\frac{|x_i|}{b}\right)\right)\\ &=-N\log 2b-\frac{1}{b}\sum_{i=1}^N|x_i| \end{aligned}\] となります．
ここで， \(\mathcal{L}_{x_1,\dots,x_N}(b)\) が最大となるような \(b\) を求めます． \[\begin{aligned} \frac{d\mathcal{L}_{x_1,\dots,x_N}}{db}(b)&=-\frac{N}{b}+\frac{1}{b^2}\sum_{i=1}^N|x_i|\\ &=-\frac{N}{b^2}\left(b-\frac{1}{N}\sum_{i=1}^N|x_i|\right),\\ \frac{d^2\mathcal{L}_{x_1,\dots,x_N}}{db^2}(b)&=\frac{N}{b^2}-\frac{2}{b^3}\sum_{i=1}^N|x_i|\\ &=\frac{N}{b^3}\left(b-\frac{2}{N}\sum_{i=1}^N|x_i|\right) \end{aligned}\] なので， \(b=(1/N)\sum_{i=1}^N|x_i|\) とすると， \(d\mathcal{L}_{x_1,\dots,x_N}/db=0\) , \(d^2\mathcal{L}_{x_1,\dots,x_N}/db^2=-(1/b^3)\sum_{i=1}^N|x_i|<0\) なので， \(b=(1/N)\sum_{i=1}^N|x_i|\) で \(\mathcal{L}_{x_1,\dots,x_N}(b)\) は最大値をとります．
よって， \(x_1,x_2,\dots,x_N\) がパラメータ \(\mu,b\) のラプラス分布からサンプリングされた乱数であって， \(\mu=0\) が既知であれば， \(b=(1/N)\sum_{i=1}^N|x_i|\) と推定することができます．
このように，対数尤度関数 \(\mathcal{L}_{x_1,\dots,x_N}(b)\) を最大化してパラメータを推定する方法を，最尤推定 といいます1．"><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://htakeuchi0.github.io/docs/math/stat/lap/mle/"><meta property="og:site_name" content="htakeuchi0 のノート"><meta property="og:title" content="特殊なラプラス分布や切断ラプラス分布のパラメータ推定"><meta property="og:description" content="特殊なラプラス分布や切断ラプラス分布のパラメータ推定 # 概要 # 前ページ では，ラプラス分布や切断ラプラス分布からのサンプリングについてまとめました．
本ページでは，ラプラス分布や切断ラプラス分布に従う乱数から，各分布のパラメータを推定する方法についてまとめます．
ただし，本節は，簡易な直接計算でラプラス分布の性質を述べることを目的としているので，すべてのパラメータでなく，一部のパラメータのみを推定する場合を考えます．
具体的には， \(\mu\) は \(0\) に固定し，切断ラプラス分布では左右対称な分布となるケースのみを考えます．
\(\mu=0\) であるラプラス分布のパラメータ推定 # いま， \(X_1,X_2,\dots,X_N\) を，独立にパラメータ \(\mu,b\) のラプラス分布に従う確率変数とし， \(\mu=0\) とします．
このとき， \[ f_{X_1,X_2,\dots,X_N}(x_1,x_2,\dots,x_N;b)=\prod_{i=1}^N\frac{1}{2b}\exp\left(-\frac{|x_i|}{b}\right)\] と表されます． \(\mathcal{L}_{x_1,\dots,x_N}(b)=\log f_{X_1,X_2,\dots,X_N}(x_1,x_2,\dots,x_N;b)\) とおくと， \[\begin{aligned} \mathcal{L}_{x_1,\dots,x_N}(b)&=\log\prod_{i=1}^N\frac{1}{2b}\exp\left(-\frac{|x_i|}{b}\right)\\ &=\sum_{i=1}^N\left(\log\frac{1}{2b}+\log\exp\left(-\frac{|x_i|}{b}\right)\right)\\ &=-N\log 2b-\frac{1}{b}\sum_{i=1}^N|x_i| \end{aligned}\] となります．
ここで， \(\mathcal{L}_{x_1,\dots,x_N}(b)\) が最大となるような \(b\) を求めます． \[\begin{aligned} \frac{d\mathcal{L}_{x_1,\dots,x_N}}{db}(b)&=-\frac{N}{b}+\frac{1}{b^2}\sum_{i=1}^N|x_i|\\ &=-\frac{N}{b^2}\left(b-\frac{1}{N}\sum_{i=1}^N|x_i|\right),\\ \frac{d^2\mathcal{L}_{x_1,\dots,x_N}}{db^2}(b)&=\frac{N}{b^2}-\frac{2}{b^3}\sum_{i=1}^N|x_i|\\ &=\frac{N}{b^3}\left(b-\frac{2}{N}\sum_{i=1}^N|x_i|\right) \end{aligned}\] なので， \(b=(1/N)\sum_{i=1}^N|x_i|\) とすると， \(d\mathcal{L}_{x_1,\dots,x_N}/db=0\) , \(d^2\mathcal{L}_{x_1,\dots,x_N}/db^2=-(1/b^3)\sum_{i=1}^N|x_i|<0\) なので， \(b=(1/N)\sum_{i=1}^N|x_i|\) で \(\mathcal{L}_{x_1,\dots,x_N}(b)\) は最大値をとります．
よって， \(x_1,x_2,\dots,x_N\) がパラメータ \(\mu,b\) のラプラス分布からサンプリングされた乱数であって， \(\mu=0\) が既知であれば， \(b=(1/N)\sum_{i=1}^N|x_i|\) と推定することができます．
このように，対数尤度関数 \(\mathcal{L}_{x_1,\dots,x_N}(b)\) を最大化してパラメータを推定する方法を，最尤推定 といいます1．"><meta property="og:locale" content="ja_jp"><meta property="og:type" content="article"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2024-06-13T22:52:52+09:00"><title>特殊なラプラス分布や切断ラプラス分布のパラメータ推定 | htakeuchi0 のノート</title>
<link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.a82d7e77ceb134d151c4d7e381eeb30623fbd5a524d58c584d8716ecec0205bd.css integrity="sha256-qC1+d86xNNFRxNfjge6zBiP71aUk1YxYTYcW7OwCBb0=" crossorigin=anonymous><script async src="https://www.googletagmanager.com/gtag/js?id=G-RXNBZFC7LX"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-RXNBZFC7LX")}</script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>htakeuchi0 のノート</span></a></h2><ul><li><a href=/docs/cpp/>C++</a><ul><li><a href=/docs/cpp/env/>開発環境</a><ul><li><a href=/docs/cpp/env/make/>Makefile プロジェクト</a></li><li><a href=/docs/cpp/env/autoconf/>autoconf プロジェクト (1)</a></li><li><a href=/docs/cpp/env/autoconf2/>autoconf プロジェクト (2)</a></li><li><a href=/docs/cpp/env/autoconf3/>autoconf プロジェクト (3)</a></li><li><a href=/docs/cpp/env/autoconf4/>autoconf プロジェクト (4)</a></li><li><a href=/docs/cpp/env/cmake/>CMake プロジェクト (1)</a></li><li><a href=/docs/cpp/env/cmake2/>CMake プロジェクト (2)</a></li></ul></li><li><a href=/docs/cpp/fp/>関数ポインタ</a><ul><li><a href=/docs/cpp/fp/fp/>関数ポインタとその周辺</a></li><li><a href=/docs/cpp/fp/mfp/>メンバ関数ポインタとその周辺</a></li><li><a href=/docs/cpp/fp/stdfunc/>std::function とその周辺</a></li><li><a href=/docs/cpp/fp/fref/>関数への参照</a></li></ul></li><li><a href=/docs/cpp/arrp/>配列へのポインタ</a><ul><li><a href=/docs/cpp/arrp/arrp/>配列へのポインタとその周辺</a></li><li><a href=/docs/cpp/arrp/arr_ref/>配列への参照</a></li><li><a href=/docs/cpp/arrp/stdarray/>std::array について</a></li></ul></li><li><a href=/docs/cpp/mmul/>行列積の計算時間</a><ul><li><a href=/docs/cpp/mmul/basic/>行列を表現するデータ構造と行列積の計算時間</a></li></ul></li></ul></li><li><a href=/docs/math/>数学一般</a><ul><li><a href=/docs/math/exp/>指数関数の定積分</a></li><li><a href=/docs/math/exp_normal/>指数関数の定積分：正規分布の累積分布関数の計算への応用</a></li><li><a href=/docs/math/stat/>数理統計</a><ul><li><a href=/docs/math/stat/dice/>サイコロの出目の確率</a><ul><li><a href=/docs/math/stat/dice/dice_basic/>サイコロを繰り返し投げる試行の確率モデル</a></li><li><a href=/docs/math/stat/dice/dice_ratio/>サイコロをN回投げたときちょうど6回に1回の割合で1の目が出る確率</a></li><li><a href=/docs/math/stat/dice/dice_approx_ratio/>サイコロをN回投げたときおよそ6回に1回程度の割合で1の目が出ることの確認</a></li><li><a href=/docs/math/stat/dice/dice_randval/>サイコロをN回投げたときおよそ6回に1回程度の割合で1の目が出ることの確率変数の導入による整理</a></li><li><a href=/docs/math/stat/dice/dice_inf/>サイコロを無限回投げる場合の確率モデル</a></li></ul></li><li><a href=/docs/math/stat/dp/>差分プライバシ</a><ul><li><a href=/docs/math/stat/dp/basic/>差分プライバシの基本</a></li></ul></li><li><a href=/docs/math/stat/lap/>ラプラス分布</a><ul><li><a href=/docs/math/stat/lap/trunclap/>ラプラス分布と切断ラプラス分布</a></li><li><a href=/docs/math/stat/lap/sampling/>ラプラス分布や切断ラプラス分布からのサンプリング</a></li><li><a href=/docs/math/stat/lap/mle/ class=active>特殊なラプラス分布や切断ラプラス分布のパラメータ推定</a></li></ul></li></ul></li><li><a href=/docs/math/year2023/>2023</a><ul><li><a href=/docs/math/year2023/year2023_2/>2023 - 実装改良編</a></li></ul></li><li><a href=/docs/math/plarail/>プラレールのある数学的定式化について</a><ul><li><a href=/docs/math/plarail/rail/>レール</a></li><li><a href=/docs/math/plarail/layout/>レイアウト</a></li><li><a href=/docs/math/plarail/plarail-problems/>プラレール問題</a></li></ul></li></ul></li><li><a href=/docs/hugo/>Hugo</a><ul><li><a href=/docs/hugo/base/>空のサイトの生成</a></li><li><a href=/docs/hugo/set_config/>ページの追加とサイトの設定</a></li><li><a href=/docs/hugo/genpages/>公開用ファイルの生成</a></li><li><a href=/docs/hugo/shortcode/>独自ショートコードの定義</a></li><li><a href=/docs/hugo/book_katex/>Book テーマの hint ショートコードブロック内に数式を表示する際の注意</a></li></ul></li><li><a href=/docs/others/>その他</a><ul><li><a href=/docs/others/pmbok/>プロジェクトマネジメント知識体系 (PMBOK) ガイドに関するノート</a></li></ul></li></ul><ul><li><a href=/#disclaimer target=_blank rel=noopener>免責事項</a></li><li><a href=/#privacy_policy target=_blank rel=noopener>プライバシーポリシー</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu>
</label><strong>特殊なラプラス分布や切断ラプラス分布のパラメータ推定</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#概要>概要</a></li><li><a href=#mu0-であるラプラス分布のパラメータ推定>\(\mu=0\) であるラプラス分布のパラメータ推定</a></li><li><a href=#mu0-である対称な切断ラプラス分布のパラメータ推定>\(\mu=0\) である対称な切断ラプラス分布のパラメータ推定</a></li><li><a href=#数値実験>数値実験</a><ul><li><a href=#典型的なパラメータでの推定結果>典型的なパラメータでの推定結果</a></li><li><a href=#乱数パラメータでの推定結果>乱数パラメータでの推定結果</a></li><li><a href=#python-による実装例>Python による実装例</a></li></ul></li><li><a href=#まとめ>まとめ</a></li><li><a href=#参考文献>参考文献</a></li></ul></nav></aside></header><article class=markdown><h1 id=特殊なラプラス分布や切断ラプラス分布のパラメータ推定>特殊なラプラス分布や切断ラプラス分布のパラメータ推定
<a class=anchor href=#%e7%89%b9%e6%ae%8a%e3%81%aa%e3%83%a9%e3%83%97%e3%83%a9%e3%82%b9%e5%88%86%e5%b8%83%e3%82%84%e5%88%87%e6%96%ad%e3%83%a9%e3%83%97%e3%83%a9%e3%82%b9%e5%88%86%e5%b8%83%e3%81%ae%e3%83%91%e3%83%a9%e3%83%a1%e3%83%bc%e3%82%bf%e6%8e%a8%e5%ae%9a>#</a></h1><h2 id=概要>概要
<a class=anchor href=#%e6%a6%82%e8%a6%81>#</a></h2><p><a href=https://htakeuchi0.github.io/docs/math/stat/lap/sampling/>前ページ</a> では，ラプラス分布や切断ラプラス分布からのサンプリングについてまとめました．</p><p>本ページでは，ラプラス分布や切断ラプラス分布に従う乱数から，各分布のパラメータを推定する方法についてまとめます．</p><p>ただし，本節は，簡易な直接計算でラプラス分布の性質を述べることを目的としているので，すべてのパラメータでなく，一部のパラメータのみを推定する場合を考えます．</p><p>具体的には，
<link rel=stylesheet href=/katex/katex.min.css><script defer src=/katex/katex.min.js></script><script defer src=/katex/auto-render.min.js onload=renderMathInElement(document.body)></script><span>\(\mu\)
</span>は <span>\(0\)
</span>に固定し，切断ラプラス分布では左右対称な分布となるケースのみを考えます．</p><h2 id=mu0-であるラプラス分布のパラメータ推定>\(\mu=0\) であるラプラス分布のパラメータ推定
<a class=anchor href=#mu0-%e3%81%a7%e3%81%82%e3%82%8b%e3%83%a9%e3%83%97%e3%83%a9%e3%82%b9%e5%88%86%e5%b8%83%e3%81%ae%e3%83%91%e3%83%a9%e3%83%a1%e3%83%bc%e3%82%bf%e6%8e%a8%e5%ae%9a>#</a></h2><p>いま，<span>
\(X_1,X_2,\dots,X_N\)
</span>を，独立にパラメータ <span>\(\mu,b\)
</span>のラプラス分布に従う確率変数とし，<span>
\(\mu=0\)
</span>とします．</p><p>このとき，
<span>\[ f_{X_1,X_2,\dots,X_N}(x_1,x_2,\dots,x_N;b)=\prod_{i=1}^N\frac{1}{2b}\exp\left(-\frac{|x_i|}{b}\right)\]
</span>と表されます．
<span>\(\mathcal{L}_{x_1,\dots,x_N}(b)=\log f_{X_1,X_2,\dots,X_N}(x_1,x_2,\dots,x_N;b)\)
</span>とおくと，
<span>\[\begin{aligned}
\mathcal{L}_{x_1,\dots,x_N}(b)&=\log\prod_{i=1}^N\frac{1}{2b}\exp\left(-\frac{|x_i|}{b}\right)\\
&=\sum_{i=1}^N\left(\log\frac{1}{2b}+\log\exp\left(-\frac{|x_i|}{b}\right)\right)\\
&=-N\log 2b-\frac{1}{b}\sum_{i=1}^N|x_i|
\end{aligned}\]
</span>となります．</p><p>ここで，<span>
\(\mathcal{L}_{x_1,\dots,x_N}(b)\)
</span>が最大となるような <span>\(b\)
</span>を求めます．
<span>\[\begin{aligned}
\frac{d\mathcal{L}_{x_1,\dots,x_N}}{db}(b)&=-\frac{N}{b}+\frac{1}{b^2}\sum_{i=1}^N|x_i|\\
&=-\frac{N}{b^2}\left(b-\frac{1}{N}\sum_{i=1}^N|x_i|\right),\\
\frac{d^2\mathcal{L}_{x_1,\dots,x_N}}{db^2}(b)&=\frac{N}{b^2}-\frac{2}{b^3}\sum_{i=1}^N|x_i|\\
&=\frac{N}{b^3}\left(b-\frac{2}{N}\sum_{i=1}^N|x_i|\right)
\end{aligned}\]
</span>なので，<span>
\(b=(1/N)\sum_{i=1}^N|x_i|\)
</span>とすると，<span>
\(d\mathcal{L}_{x_1,\dots,x_N}/db=0\)
</span>, <span>\(d^2\mathcal{L}_{x_1,\dots,x_N}/db^2=-(1/b^3)\sum_{i=1}^N|x_i|&lt;0\)
</span>なので，<span>
\(b=(1/N)\sum_{i=1}^N|x_i|\)
</span>で <span>\(\mathcal{L}_{x_1,\dots,x_N}(b)\)
</span>は最大値をとります．</p><p>よって，<span>
\(x_1,x_2,\dots,x_N\)
</span>がパラメータ <span>\(\mu,b\)
</span>のラプラス分布からサンプリングされた乱数であって，<span>
\(\mu=0\)
</span>が既知であれば，<span>
\(b=(1/N)\sum_{i=1}^N|x_i|\)
</span>と推定することができます．</p><p>このように，<strong>対数尤度関数</strong> <span>\(\mathcal{L}_{x_1,\dots,x_N}(b)\)
</span>を最大化してパラメータを推定する方法を，<strong>最尤推定</strong> といいます<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>．</p><h2 id=mu0-である対称な切断ラプラス分布のパラメータ推定>\(\mu=0\) である対称な切断ラプラス分布のパラメータ推定
<a class=anchor href=#mu0-%e3%81%a7%e3%81%82%e3%82%8b%e5%af%be%e7%a7%b0%e3%81%aa%e5%88%87%e6%96%ad%e3%83%a9%e3%83%97%e3%83%a9%e3%82%b9%e5%88%86%e5%b8%83%e3%81%ae%e3%83%91%e3%83%a9%e3%83%a1%e3%83%bc%e3%82%bf%e6%8e%a8%e5%ae%9a>#</a></h2><p>いま，<span>
\(X_1,X_2,\dots,X_N\)
</span>を，独立に同一の分布に従う確率変数とし，その確率密度関数が，
<span>\[\begin{aligned}
&amp;f_{X_i}(x;b,A)=\begin{cases}
\dfrac{1}{2bC_{b}(A)}\exp\left(-\dfrac{|x|}{b}\right),&-A\le x\le A,\\
0,&\text{otherwise},
\end{cases},\\
&amp;C_{b}(A)=1-\exp\left(-\dfrac{A}{b}\right)
\end{aligned}\]
</span>であるとします．
これは，切断ラプラス分布の特殊な場合ものです．</p><p>前節と同様に，<span>
\(\mathcal{L}_{x_1,\dots,x_N}(b,A)=\log f_{X_1,X_2,\dots,X_N}(x_1,x_2,\dots,x_N;b,A)\)
</span>とおくと，
<span>\[\begin{aligned}
\mathcal{L}_{x_1,\dots,x_N}(b,A)&=\log\prod_{i=1}^N\frac{1}{2bC_b(A)}\exp\left(-\frac{|x_i|}{b}\right)\\
&=\sum_{i=1}^N\left(\log\frac{1}{2bC_b(A)}+\log\exp\left(-\frac{|x_i|}{b}\right)\right)\\
&=-N\log 2bC_b(A)-\frac{1}{b}\sum_{i=1}^N|x_i|
\end{aligned}\]
</span>となります．</p><p>まず，<span>
\(b>0\)
</span>とすると，<span>
\(A\to0\)
</span>のとき <span>\(\mathcal{L}_{x_1,\dots,x_N}(b,A)\to+\infty\)
</span>なので，<span>
\(A\)
</span>は小さければ小さいほどよいです．
一方で，すべての <span>\(i\)
</span>について <span>\(|x_i|\le A\)
</span>となる必要があるため，<span>
\(A=\max_{i=1,2,\dots,N}|x_i|\)
</span>と推定することにします．</p><p>次に，<span>
\(b\)
</span>について考えます．
偏導関数に着目すると，</p><p><span>\[\begin{aligned}
&\frac{\partial\mathcal{L}_{x_1,\dots,x_N}}{\partial b}(b,A)\\
&\quad=-\frac{N}{b^2}\left(b-\frac{A}{\exp(A/b)-1}-\frac{1}{N}\sum_{i=1}^N|x_i|\right),\\
\end{aligned}\]
</span>となります．</p><p>ここで，</p><ul><li><span>\(b\to+0\)
</span>において，<span>
\((\partial\mathcal{L}_{x_1,\dots,x_N}/\partial b)(b,A)\to+\infty\)</span></li><li><span>\(b\to+\infty\)
</span>において，<span>
\((\partial\mathcal{L}_{x_1,\dots,x_N}/\partial b)(b,A)\to+0\)</span></li></ul><p>であることがわかります．</p><p>さらに，<span>
\(b-(1/N)\sum_{i=1}^N|x_i|\)
</span>は <span>\(b\)
</span>に関する1次関数，<span>
\(A/(\exp(A/b)-1)\)
</span>は <span>\(b\)
</span>に関する狭義凸関数なので，これら関数のグラフは高々2点で交わります．よって，<span>
\(b\)
</span>に関する方程式 <span>\((\partial\mathcal{L}_{x_1,\dots,x_N}/\partial b)(b,A)=0\)
</span>は高々2個の実数解をもちます．</p><p><span>\(b\approx0\)
</span>において <span>\((\partial\mathcal{L}_{x_1,\dots,x_N}/\partial b)(b,A)>0\)
</span>で，<span>
\(b\)
</span>が十分大きい範囲で <span>\((\partial\mathcal{L}_{x_1,\dots,x_N}/\partial b)(b,A)>0\)
</span>なので，偏導関数の連続性から，次のいずれかが成り立ちます．</p><ul><li>常に <span>\((\partial\mathcal{L}_{x_1,\dots,x_N}/\partial b)(b,A)\ge0\)
</span>である，</li><li><span>\((\partial\mathcal{L}_{x_1,\dots,x_N}/\partial b)(b,A)=0\)
</span>は異なる2個の実数解をもち，小さい方の解 <span>\(b^*\)
</span>は，<span>
\((\partial\mathcal{L}_{x_1,\dots,x_N}/\partial b)(b,A)\)
</span>が正から負に変化する零点である．</li></ul><p>さらに，<span>
\(b\to+\infty\)
</span>のとき，<span>
\(\mathcal{L}_{x_1,\dots,x_N}(b,A)\to-N\log 2A\)
</span>であることに注意すると，<span>
\(b^*\)
</span>が存在し，かつ <span>\(\mathcal{L}_{x_1,\dots,x_N}(b^*,A)\ge-N\log 2A\)
</span>のとき <span>\(b^*\)
</span>をパラメータ <span>\(b\)
</span>の推定値とできることがわかります．</p><p>ただし，解くべき以下の方程式は，一般に解析的に解けないので，数値的に解く必要があります．
<span>\[ b=\frac{A}{\exp(A/b)-1}+\frac{1}{N}\sum_{i=1}^N|x_i|\]</span></p><p>なお，
<span>\[\begin{aligned}
&\frac{\partial^2\mathcal{L}_{x_1,\dots,x_N}}{\partial b^2}(b,A)\\
&\quad=\frac{N}{b^4}\left(\frac{A^2\exp(A/b)}{(\exp(A/b)-1)^2}-\frac{2Ab}{\exp(A/b)-1}+b\left(b-\frac{2}{N}\sum_{i=1}^N|x_i|\right)\right)
\end{aligned}\]
</span>と表せることを利用して，数値的に得られた <span>\(b^*\)
</span>が極大点であることを確認することができます．</p><h2 id=数値実験>数値実験
<a class=anchor href=#%e6%95%b0%e5%80%a4%e5%ae%9f%e9%a8%93>#</a></h2><p>実際に切断ラプラス分布に従う乱数を生成し，本ページの方法でパラメータ推定を行います．</p><p>条件は以下のとおりとします．</p><ul><li>サンプリング数 <span>\(N=100000\)
</span>とします．</li><li>乱数生成は<a href=https://htakeuchi0.github.io/docs/math/stat/lap/sampling/>前ページ</a>の方法で行います．</li><li><span>\(b\)
</span>に関する方程式は，初期値を <span>\(1\)
</span>, 収束判定条件を残差の絶対値が <span>\(10^{-15}\)
</span>未満であることとするNewton法で求めます．</li></ul><h3 id=典型的なパラメータでの推定結果>典型的なパラメータでの推定結果
<a class=anchor href=#%e5%85%b8%e5%9e%8b%e7%9a%84%e3%81%aa%e3%83%91%e3%83%a9%e3%83%a1%e3%83%bc%e3%82%bf%e3%81%a7%e3%81%ae%e6%8e%a8%e5%ae%9a%e7%b5%90%e6%9e%9c>#</a></h3><p>まずは，典型的なパラメータで推定できるかを確認します．
結果は以下のとおりで，正しく推定できていることがわかります．</p><table><thead><tr><th><span>\(A\)</span></th><th><span>\(b\)</span></th><th><span>\(A\)
</span>の推定値</th><th><span>\(b\)
</span>の推定値</th></tr></thead><tbody><tr><td>1.0</td><td>1.0</td><td>0.999994</td><td>0.996397</td></tr><tr><td>5.0</td><td>2.0</td><td>4.999925</td><td>2.004784</td></tr><tr><td>1.0</td><td>0.1</td><td>0.984138</td><td>0.099924</td></tr></tbody></table><h3 id=乱数パラメータでの推定結果>乱数パラメータでの推定結果
<a class=anchor href=#%e4%b9%b1%e6%95%b0%e3%83%91%e3%83%a9%e3%83%a1%e3%83%bc%e3%82%bf%e3%81%a7%e3%81%ae%e6%8e%a8%e5%ae%9a%e7%b5%90%e6%9e%9c>#</a></h3><p>次に，<span>
\(A\)
</span>, <span>\(b\)
</span>をそれぞれ <span>\(0.1\)
</span>以上 <span>\(5\)
</span>以下の一様乱数で決めて，それらパラメータが推定できるかを確認します．
パラメータ推定を1000回行い，<span>
\((A,b)\)
</span>によらず計算できるかを確認します．</p><p>実行した結果，計算が収束した割合は 98.3% でした．
1000回のうち17回は，Newton 法が収束せず，解が得られませんでした．</p><p>ここで，収束した場合としなかった場合でどのような差があるかを確認します．</p><p>まず，収束した場合の <span>\(A\)
</span>, <span>\(b\)
</span>の相対誤差は以下のとおりです<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>．</p><table><thead><tr><th></th><th>最小</th><th>中央</th><th>最大</th><th>平均</th><th>標本標準偏差</th></tr></thead><tbody><tr><td>\(A\)</td><td>3.41e-09</td><td>1.26e-05</td><td>6.75e-01</td><td>6.51e-03</td><td>5.02e-02</td></tr><tr><td>\(b\)</td><td>4.71e-06</td><td>7.18e-03</td><td>3.43e-01</td><td>1.63e-02</td><td>2.85e-02</td></tr></tbody></table><p>次に，収束しない場合の，反復終了時点の <span>\(A\)
</span>, <span>\(b\)
</span>の相対誤差は以下のとおりです．</p><table><thead><tr><th></th><th>最小</th><th>中央</th><th>最大</th><th>平均</th><th>標本標準偏差</th></tr></thead><tbody><tr><td>\(A\)</td><td>2.68e-07</td><td>7.35e-06</td><td>3.81e-05</td><td>9.58e-06</td><td>9.36e-06</td></tr><tr><td>\(b\)</td><td>3.30e-02</td><td>1.15e-01</td><td>6.15e-01</td><td>1.66e-01</td><td>1.51e-01</td></tr></tbody></table><p><span>\(b\)
</span>の相対誤差の平均値，中央値，最大値は，収束したかどうかで変わらないように見えます．一方で，<span>
\(b\)
</span>の相対誤差の最小値を比較すると，反復が終了した場合の方が誤差が小さいので，反復が収束する場合の方が精度よく求まるケースはあるようです．
ですので，収束した場合に精度よく求まるケースが観測されたものの，収束したかどうかで精度が明確に異なるとも言い難いという結果になりました．</p><p>ところで，収束した場合の <span>\(A\)
</span>の平均値が 2.59205, 収束しなかった場合の <span>\(A\)
</span>の平均値が 0.234635 なので，切断点が小さいときに，収束が難しい可能性があります．
<span>\(A,b\)
</span>の組み合わせによる可能性もありますので，正確に条件を把握するために，計算に成功した場合と失敗した場合の <span>\((A,b)\)
</span>をプロットしてみます．</p><figure class=text-center><img src=/images/docs/math/stat/lap/sucfail.png><figcaption><h4>Figure 1. 計算に成功した場合と失敗した場合の \((A,b)\)</h4></figcaption></figure><p>Fug. 1 より，<span>
\(A\)
</span>が小さく，<span>
\(b\)
</span>が大きい場合に失敗しやすいことがわかります．</p><p>まとめると，以下のようになります．</p><ul><li>収束したかどうかで，精度が明確に異なるとは言い難い．</li><li>収束しても精度よく求まるとは限らないが，収束した場合に精度よく求まったケースはあった．</li><li><span>\(A\)
</span>が小さく <span>\(b\)
</span>が大きい場合に収束が難しい可能性がある．</li></ul><p>以上より，<span>
\(b\)
</span>を数値的に求める方法に検討の余地があると考えられます．</p><h3 id=python-による実装例>Python による実装例
<a class=anchor href=#python-%e3%81%ab%e3%82%88%e3%82%8b%e5%ae%9f%e8%a3%85%e4%be%8b>#</a></h3><p>Python による実装例は以下のとおりです．
また，本数値実験は，以下の実装で行いました．</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> numpy <span style=color:#66d9ef>as</span> np
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> scipy.stats <span style=color:#66d9ef>as</span> stats
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>estimate</span>(random_values):
</span></span><span style=display:flex><span>    a <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>max(np<span style=color:#f92672>.</span>abs(random_values))
</span></span><span style=display:flex><span>    m <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>mean(np<span style=color:#f92672>.</span>abs(random_values))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    b <span style=color:#f92672>=</span> <span style=color:#ae81ff>1.0</span>
</span></span><span style=display:flex><span>    max_loop <span style=color:#f92672>=</span> <span style=color:#ae81ff>100000</span>
</span></span><span style=display:flex><span>    threshold <span style=color:#f92672>=</span> <span style=color:#ae81ff>1.0e-15</span>
</span></span><span style=display:flex><span>    converged <span style=color:#f92672>=</span> <span style=color:#66d9ef>False</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> _ <span style=color:#f92672>in</span> range(max_loop):
</span></span><span style=display:flex><span>        exp_a_b <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>exp(a <span style=color:#f92672>/</span> b)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> np<span style=color:#f92672>.</span>abs(b <span style=color:#f92672>-</span> a <span style=color:#f92672>/</span> (exp_a_b <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>-</span> m) <span style=color:#f92672>&lt;</span> threshold:
</span></span><span style=display:flex><span>            converged <span style=color:#f92672>=</span> <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        c <span style=color:#f92672>=</span> a <span style=color:#f92672>/</span> (b <span style=color:#f92672>*</span> (exp_a_b <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>))
</span></span><span style=display:flex><span>        b <span style=color:#f92672>-=</span> (b <span style=color:#f92672>-</span> a<span style=color:#f92672>/</span>(exp_a_b <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>-</span> m)<span style=color:#f92672>/</span>(<span style=color:#ae81ff>1</span> <span style=color:#f92672>+</span> c<span style=color:#f92672>*</span>c<span style=color:#f92672>*</span>exp_a_b)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> converged:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>RuntimeError</span>(<span style=color:#e6db74>&#39;Did not converge. (A=</span><span style=color:#e6db74>{}</span><span style=color:#e6db74>, b=</span><span style=color:#e6db74>{}</span><span style=color:#e6db74>)&#39;</span><span style=color:#f92672>.</span>format(a, b))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    exp_a_b <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>exp(a <span style=color:#f92672>/</span> b)
</span></span><span style=display:flex><span>    d <span style=color:#f92672>=</span> a <span style=color:#f92672>/</span> (exp_a_b <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    n <span style=color:#f92672>=</span> len(random_values)
</span></span><span style=display:flex><span>    f <span style=color:#f92672>=</span> <span style=color:#f92672>-</span>n<span style=color:#f92672>*</span>np<span style=color:#f92672>.</span>log(<span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>b<span style=color:#f92672>*</span>(<span style=color:#ae81ff>1</span> <span style=color:#f92672>-</span> np<span style=color:#f92672>.</span>exp(<span style=color:#f92672>-</span>a <span style=color:#f92672>/</span> b))) <span style=color:#f92672>-</span> m<span style=color:#f92672>*</span>n <span style=color:#f92672>/</span> b
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> f <span style=color:#f92672>&lt;</span> <span style=color:#f92672>-</span>n<span style=color:#f92672>*</span>np<span style=color:#f92672>.</span>log(<span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>a):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>RuntimeError</span>(<span style=color:#e6db74>&#39;Failed.&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    ddf <span style=color:#f92672>=</span> (n <span style=color:#f92672>/</span> b<span style=color:#f92672>**</span><span style=color:#ae81ff>4</span>)<span style=color:#f92672>*</span>(d<span style=color:#f92672>*</span>d<span style=color:#f92672>*</span>exp_a_b <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>b<span style=color:#f92672>*</span>d <span style=color:#f92672>+</span> b<span style=color:#f92672>*</span>(b <span style=color:#f92672>-</span> <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>m))
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ddf <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>RuntimeError</span>(<span style=color:#e6db74>&#39;Failed.&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> a, b
</span></span></code></pre></div><h2 id=まとめ>まとめ
<a class=anchor href=#%e3%81%be%e3%81%a8%e3%82%81>#</a></h2><p>本ページでは，一部のパラメータが既知である，特殊なラプラス分布や切断ラプラス分布のパラメータ推定方法についてまとめました．</p><p><span>\(\mu=0\)
</span>のラプラス分布では，<span>
\(b\)
</span>が簡単に推定できますが，切断ラプラス分布の場合は，一般には数値的にしか求まらないことがわかりました．</p><p>数値実験では，典型的な例では，切断ラプラス分布のパラメータが推定できていそうな様子は確認できましたが，計算が収束しない場合があることもわかりました．</p><p>パラメータよらず，より確実にパラメータ推定を行う方法や，本ページの方法を，一般の切断ラプラス分布のパラメータ推定に拡張する方法は，現時点でわかっておらず，今後の課題です．</p><h2 id=参考文献>参考文献
<a class=anchor href=#%e5%8f%82%e8%80%83%e6%96%87%e7%8c%ae>#</a></h2><p><a id=wiki:1></a>[1] Wikipedia，“Laplace distribution - Wikipedia”, <a href=https://en.wikipedia.org/wiki/Laplace_distribution#Statistical_inference>https://en.wikipedia.org/wiki/Laplace_distribution#Statistical_inference</a>, 2024/6/6 最終アクセス．</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><span>\(\mu\)
</span>が未知の場合，<span>
\(x_1,\dots,x_N\)
</span>の中央値を <span>\(\mu\)
</span>の推定値として，その推定値を用いて <span>\(b=(1/N)\sum_{i=1}^N|x_i-\mu|\)
</span>と推定できることが知られています <a href=#wiki:1>[1]</a>．&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>3.41e-09 とは <span>\(3.41\times10^{-9}\)
</span>という意味で，ほかも同様です．&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></article><hr><p><small><a rel=license href="https://creativecommons.org/licenses/by-nd/4.0/deed.ja?_fsi=E6fL9iEx"><img src=https://i.creativecommons.org/l/by-nd/4.0/88x31.png alt=クリエイティブ・コモンズ・ライセンス style=border-width:0></a><br>本ページは <a rel=license href="https://creativecommons.org/licenses/by-nd/4.0/deed.ja?_fsi=E6fL9iEx">クリエイティブ・コモンズ 表示 - 改変禁止 4.0 国際ライセンス (CC BY-ND 4.0)</a> の下に提供されています。</small></p><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/htakeuchi0/htakeuchi0.github.io-sources/commit/1bbc782285e3e196f198324efbbbacfaf41e0ea4 title='Last modified by htakeuchi0 | June 13, 2024' target=_blank rel=noopener><img src=/svg/calendar.svg class=book-icon alt=Calendar>
<span>June 13, 2024</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#概要>概要</a></li><li><a href=#mu0-であるラプラス分布のパラメータ推定>\(\mu=0\) であるラプラス分布のパラメータ推定</a></li><li><a href=#mu0-である対称な切断ラプラス分布のパラメータ推定>\(\mu=0\) である対称な切断ラプラス分布のパラメータ推定</a></li><li><a href=#数値実験>数値実験</a><ul><li><a href=#典型的なパラメータでの推定結果>典型的なパラメータでの推定結果</a></li><li><a href=#乱数パラメータでの推定結果>乱数パラメータでの推定結果</a></li><li><a href=#python-による実装例>Python による実装例</a></li></ul></li><li><a href=#まとめ>まとめ</a></li><li><a href=#参考文献>参考文献</a></li></ul></nav></div></aside></main></body></html>